function extend(child,parent){var F=function(){};F.prototype=parent.prototype;child.prototype=new F();child.prototype.constructor=child;child.superclass=parent.prototype}
function decorate(c,methodName,method){c=getClassByName(c);var result=false;if(c){method.previousMethod='undefined'==typeof(c.prototype[methodName])?null:c.prototype[methodName];c.prototype[methodName]=method;result=true};return result}
function getClassByName(c){if(c&&c.constructor==String){c=eval('(("undefined" != typeof(window.'+c+') && '+c+'.constructor == Function) ? '+c+' : null)')}else if(!c||c.constructor!=Function)c=null;return c}
function Base(){this.triggerVent('initialize')};Base.prototype.getSuperclass=function(){var m=this.constructor.toString().match(/function ([^\(]+)/);return eval(m[1]+'.superclass')};Base.prototype.callSupermethod=function(name,args){superClass=this.getSuperclass();return superClass[name].apply(this,args)};Base.prototype.bind=function(name,handler){jQuery(this).bind(name,handler);return this};Base.prototype.unbind=function(name,handler){jQuery(this).unbind(name,handler);return this};Base.prototype.triggerVent=function(name,data){var ns=this.getEventNamespace();if(ns)core.trigger(ns+'.'+name,data);return jQuery(this).trigger('local.'+name,data)};Base.prototype.getEventNamespace=function(){return null};var reverseArguments=function(func){return function(){return func.apply(this,Array.prototype.reverse.call(arguments))}};window.core={isDebug:false,isReady:false,isRequesterEnabled:false,savedEvents:[],messages:jQuery({}),resources:[],htmlResourcesLoadDeferred:new $.Deferred(),widgetsParamsGetters:{},doShadeWidgetsCollection:true,registerWidgetsParamsGetter:function(widgetsId,getter){if(!this.widgetsParamsGetters[widgetsId])this.widgetsParamsGetters[widgetsId]=[];this.widgetsParamsGetters[widgetsId].push(getter)},getWidgetsParams:function(widgetsId,paramsToCall){var params=[];for(var key in this.widgetsParamsGetters[widgetsId])params=array_merge(params,this.widgetsParamsGetters[widgetsId][key](paramsToCall));return params},widgetsTriggers:{},registerWidgetsTriggers:function(widgetsId,triggersGetter){if(!this.widgetsTriggers[widgetsId])this.widgetsTriggers[widgetsId]=[];this.widgetsTriggers[widgetsId].push(triggersGetter)},getWidgetsTriggers:function(widgetsId){var triggers=[];for(var key in this.widgetsTriggers[widgetsId])triggers.push(this.widgetsTriggers[widgetsId][key]());return triggers},shadowWidgets:{},registerShadowWidgets:function(widgetsId,shadowGetter){if("undefined"===typeof(this.shadowWidgets[widgetsId]))this.shadowWidgets[widgetsId]=[];this.shadowWidgets[widgetsId].push(shadowGetter)},getShadowWidgets:function(widgetsId){var shadow=[];for(var key in this.shadowWidgets[widgetsId])shadow.push(this.shadowWidgets[widgetsId][key]());return array_unique(shadow)},widgetsTriggersBind:{},registerTriggersBind:function(widgetsId,triggersGetter){if(!this.widgetsTriggersBind[widgetsId])this.widgetsTriggersBind[widgetsId]=[];this.widgetsTriggersBind[widgetsId].push(triggersGetter)},callTriggersBind:function(widgetsId){for(var key in this.widgetsTriggersBind[widgetsId])this.widgetsTriggersBind[widgetsId][key]()},shadeWidgetsCollection:function(base){if(this.doShadeWidgetsCollection)jQuery(base).append('<div class="single-progress-mark"><div></div></div>');this.doShadeWidgetsCollection=true},unshadeWidgetsCollection:function(base){jQuery(base+' .single-progress-mark').remove()},processUpdateWidgetsCollection:function(widgetsId,widgetsCollection,widgetsCollectionParamsCommon,base){var triggers=this.getWidgetsTriggers(widgetsId);for(var k in triggers)jQuery(triggers[k]).unbind(k).prop('disabled','disabled');this.shadeWidgetsCollection('.product-details-info');this.loadWidgetsCollection(base,widgetsCollection,array_merge(widgetsCollectionParamsCommon,this.getWidgetsParams(widgetsId,widgetsCollectionParamsCommon)),function(){for(var k in triggers)jQuery(triggers[k]).removeProp('disabled');core.unshadeWidgetsCollection('.product-details-info');core.callTriggersBind(widgetsId)})},redirectTo:function(url){_.defer(function(){window.location.href=url})},trigger:function(name,params){var result=true;name=name.toLowerCase();if(this.isReady){if(this.isDebug&&'undefined'!=typeof(window.console))if(params){console.log('Fire \''+name+'\' event with arguments: '+var_export(params,true))}else console.log('Fire \''+name+'\' event');result=this.messages.trigger(name,[params])}else this.savedEvents.push({name:name,params:params});return result},bind:function(name,callback){if(_.isArray(name)){for(var key in name)if(name.hasOwnProperty(key))this.messages.bind(name[key].toLowerCase(),callback)}else this.messages.bind(name.toLowerCase(),callback);return this},unbind:function(name,callback){if(_.isArray(name)){for(var key in name)this.messages.unbind(name[key].toLowerCase(),callback)}else this.messages.unbind(name.toLowerCase(),callback);return this},get:function(url,callback,data,options){if(_.isObject(url))url=URLHandler.buildURL(url);options=options||{};var completeCallback=options.complete||function(){},successCallback=options.success||function(){},headers={ajaxRefererTarget:core.getTarget()};options=jQuery.extend({async:true,cache:false,contentType:'text/html',global:false,timeout:15e3,type:'GET',url:url,data:data,headers:headers},options,{complete:function(){_.partial(core.onXhrComplete,callback,options,data).apply(this,arguments);completeCallback.apply(this,arguments)},success:function(){core.onXhrSuccess.apply(this,arguments);successCallback.apply(this,arguments)}});return jQuery.ajax(options)},post:function(url,callback,data,options){if(_.isObject(url))url=URLHandler.buildURL(url);options=options||{};var completeCallback=options.complete||function(){},successCallback=options.success||function(){},headers={ajaxRefererTarget:core.getTarget()};options=jQuery.extend({async:true,cache:false,contentType:'application/x-www-form-urlencoded',global:false,timeout:15e3,type:'POST',url:url,data:data,headers:headers},options,{complete:function(){_.partial(core.onXhrComplete,callback,options,data).apply(this,arguments);completeCallback.apply(this,arguments)},success:function(){core.onXhrSuccess.apply(this,arguments);successCallback.apply(this,arguments)}});return jQuery.ajax(options)},onXhrSuccess:function(data,textStatus,XMLHttpRequest){var list=XMLHttpRequest.getAllResponseHeaders().split(/\n/),header=_.find(list,function(headerValue){return-1!==headerValue.search(/update-csrf: (.*)/i)}),matches=header?header.match(/update-csrf: (.*)/i):null;if(matches&&matches[1]){var headerData=JSON.parse(matches[1]);if(headerData.name='xcart_form_id'&&headerData.old===xliteConfig.form_id)xliteConfig.form_id=headerData.value}},onXhrComplete:function(callback,options,data,XMLHttpRequest,textStatus){var callCallback=core.preprocessResponse(XMLHttpRequest,options,callback);data=core.processResponse(XMLHttpRequest);var notValid=!!XMLHttpRequest.getResponseHeader('not-valid');return(callCallback&&callback)?callback(XMLHttpRequest,textStatus,data,!notValid):true},preprocessResponse:function(xhr,options,callback){var result=true,responseStatus=parseInt(xhr.getResponseHeader('ajax-response-status'));if(200==xhr.status&&(270==responseStatus||279==responseStatus)&&xhr.getResponseHeader('AJAX-Location')&&(!options||!options.rpc)){core.get(xhr.getResponseHeader('AJAX-Location'),callback);result=false}else if(278==responseStatus){var url=xhr.getResponseHeader('AJAX-Location');if(url)window.location.replace(url);if(!url||this.urlHasHash(url))window.location.reload(true);result=false};return result},urlHasHash:function(url){return url.indexOf("#")!==-1},processResponse:function(xhr){var responseStatus=parseInt(xhr.getResponseHeader('ajax-response-status'));if(4==xhr.readyState&&200==xhr.status){var list=xhr.getAllResponseHeaders().split(/\n/);for(var i=0;i<list.length;i++)if(-1!==list[i].search(/^event-([^:]+):(.+)/i)){var m=list[i].match(/event-([^:]+):(.+)/i);core.trigger(m[1].toLowerCase(),eval('('+m[2]+')'))}};return(4==xhr.readyState&&200==xhr.status)?xhr.responseText:false},showInternalError:function(){return this.showError(this.t('Javascript core internal error. Page will be refreshed automatically'))},showServerError:function(){return this.showError(this.t('Background request to server side is failed. Page will be refreshed automatically'))},showError:function(message){core.trigger('message',{type:'error',message:message})},translator:null,t:function(label,substitute){return this.getTranslator().translate(label,substitute)},loadLanguageHash:function(hash){return this.getTranslator().loadLanguageHash(hash)},getTranslator:function(){if(this.translator===null)this.translator=new Translator();return this.translator},getHtmlResourcesLoadPromise:function(){return this.htmlResourcesLoadDeferred.promise()},loadResource:function(resource,type){var deferred=new $.Deferred();if(_.isString(resource))resource={url:resource,widget:''};type=type||core.getExtension(resource.url);if(core.isLoadedResource(resource.url))return;LazyLoad[type](resource.url,function(){core.registerResources([resource.url]);core.trigger('resources.loaded',{file:resource.url,widget:resource.widget});deferred.resolve()});return deferred.promise()},isLoadedResource:function(url){return _.contains(core.resources,url)},registerResources:function(list){for(var key in list)core.resources.push(list[key])},parseResources:function(element,uuid){var restoreCallback=core.microhandlers.supressRun();uuid=uuid||'';element=jQuery(element);var resource=element.find('script[data-resource]').first();if(resource.length){var data=JSON.parse(resource.html());resource.remove();if(data.css||data.js){var cssLoaded=core.loadResources(data.css,'css'),jsLoaded=core.loadResources(data.js,'js');jQuery.when(cssLoaded,jsLoaded).done(function(){restoreCallback();core.trigger('resources.ready',{widget:data.widget,uuid:uuid})})}else{restoreCallback();core.trigger('resources.empty',{widget:data.widget,uuid:uuid})}}},loadResources:function(list,type){var deferred=new $.Deferred(),promises=[];$.when(this.getHtmlResourcesLoadPromise()).then(function(){for(var key in list){var resource=list[key];promises.push(core.loadResource(resource,type))};$.when.apply($,promises).then(function(){deferred.resolve()})});return deferred.promise()},parsePreloadedLabels:function(element,uuid){element=jQuery(element);uuid=uuid||'';var labelsContainer=element.find('script[data-preloaded-labels]').first();if(labelsContainer.length){var data=JSON.parse(labelsContainer.html());labelsContainer.remove();if(data.labels){core.loadLabels(data.labels);core.trigger('preloaded_labels.ready',{widget:data.widget,uuid:uuid})}else core.trigger('preloaded_labels.empty',{widget:data.widget,uuid:uuid})}},loadLabels:function(list){this.loadLanguageHash(list)},parseObjectString:function(objectString){if(typeof JSON5!=='undefined')return JSON5.parse(objectString);console.error('Cannot parse JS object from string: JSON5 is not loaded')},getLayoutOptions:function(){return window.xliteLayoutOptions||{}},rest:{lastResponse:null,request:function(type,name,id,data,callback){if(!type||!name)return false;this.lastResponse=null;var xhr=jQuery.ajax({async:false!==callback,cache:false,complete:function(xhr,status){return this.callback(xhr,status,callback)},context:this,data:data,timeout:3e4,type:('get'==type?'GET':'POST'),url:URLHandler.buildURL({target:'rest',action:type,name:name,id:id})});if(false===callback)xhr=(this.lastResponse&&this.lastResponse.status=='success')?this.lastResponse.data:null;return xhr},get:function(name,id,callback){return this.request('get',name,id,null,callback)},post:function(name,id,data,callback){return this.request('post',name,id,data,callback)},put:function(name,data,callback){return this.request('put',name,null,data,callback)},'delete':function(name,id,callback){return this.request('delete',name,id,null,callback)},callback:function(xhr,status,callback){try{var data=jQuery.parseJSON(xhr.responseText)}catch(e){var data=null};if(false===callback){core.rest.lastResponse=data}else if(callback)callback(xhr,status,data)}},clearHash:function(paramName){var scrollV,scrollH,loc=window.location,newHash='';if(paramName!==undefined){var pattern='&?('+paramName+'(\\[\\S*\\])*=[^&]*&?)',re=new RegExp(pattern,"gi");newHash=loc.hash.replace(re,'').slice(1)};scrollV=document.body.scrollTop;scrollH=document.body.scrollLeft;loc.hash=newHash;document.body.scrollTop=scrollV;document.body.scrollLeft=scrollH},autoload:function(className,element){if('function'==typeof className){var m=className.toString().match(/function ([^\(]+)/);window[m[1]]=className;className=m[1]};var classObject=window[className];jQuery(document).ready(function(){if('undefined'!=typeof classObject)if('undefined'!=typeof element){jQuery(element).each(function(index,el){jQuery(el).data('controller',new classObject(jQuery(el)))})}else if('function'==typeof(classObject.autoload)){classObject.autoload()}else new classObject()})},getValueFromClass:function(obj,prefix){var m=jQuery(obj).attr('class').match(new RegExp(prefix+'-([^ ]+)( |$)'));return m?m[1]:null},getCommentedData:function(obj,name){if(jQuery(obj).get(0)){var children=jQuery(obj).get(0).childNodes}else return name?null:[];var m=false;for(var i=0;i<children.length&&!m;i++)if('SCRIPT'==children[i].nodeName&&'text/x-cart-data'==children[i].type){m=children[i].innerHTML;m=m.replace(/^\n\r/,'').replace(/\r\n$/,'');try{m=eval('('+m+')')}catch(e){m=false}};if(m&&name)m='undefined'==typeof(m[name])?null:m[name];return m?m:null},toggleText:function(link,text,obj){if(undefined===link.prevValue)link.prevValue=jQuery(link).html();jQuery(link).html(jQuery(link).html()===text?link.prevValue:text);jQuery(obj).toggle()},setRelArray:function($obj,relArray){$obj.attr('data-rel',_.map(_.pairs(relArray),function(value){return value.join(": ")}).join(", "))},getRelArray:function($obj){var rel=$obj.attr('data-rel');return _.object(_.map(rel.split(','),function(value,key,list){return _.map(_.trim(value).split(':'),function(value){return _.trim(value)})}))},decorate:function(className,methodName,func){core.bind('load',function(){decorate(className,methodName,func)})},decorates:function(list,func){core.bind('load',function(){for(var i=0;i<list.length;i++)decorate(list[i][0],list[i][1],func)})},stringToNumber:function(number,dDelim,tDelim){if(""!==tDelim)number=number.replace(new RegExp("\\"+tDelim,'g'),'');var a=number.split(dDelim);return parseFloat(a[0]+'.'+a[1])},numberToString:function(number,dDelim,tDelim,precision){dDelim=dDelim||'.';tDelim=tDelim||'';precision=precision||0;precision=Math.max(parseInt(precision),0);number=this.round(number,precision).toString();var a=number.split('.'),x=a[0],y=a[1],z='';if(typeof x!='undefined'){for(var i=x.length-1;i>=0;i--)z+=x.charAt(i);z=z.replace(/(\d{3})/g,"$1"+tDelim);if(z.slice(-tDelim.length)==tDelim)z=z.slice(0,-tDelim.length);x='';for(i=z.length-1;i>=0;i--)x+=z.charAt(i);if(typeof y!='undefined'&&y.length>0){x+=dDelim+y+this.repeat('0',precision-y.length)}else if(precision>0)x+=dDelim+this.repeat('0',precision)};return x},getExtension:function(path){return path.slice((path.lastIndexOf(".")-1>>>0)+2)},repeat:function(s,n){var a=[];while(a.length<n)a.push(s);return a.join('')},round:function(number,precision){precision=precision||0;precision=Math.max(parseInt(precision),0);var pow=Math.pow(10,precision);return Math.round(number*pow)/pow},loadWidgetsCollection:function(base,collectionName,params,restoreCallback){this.get(URLHandler.buildURL(array_merge({target:'widgets_collection',action:'get',widget:collectionName},params)),function(XMLHttpRequest,textStatus,data){try{data=JSON.parse(data);for(var key in data)jQuery('.'+data[key].view,jQuery(base)).replaceWith(data[key].content);restoreCallback()}catch(error){console.log(error.message)}})},shadowCollection:function(base,collection){for(key in collection)jQuery(collection[key],jQuery(base)).after('<div class="single-progress-mark"></div>')},unshadowWidget:function(base,widget){jQuery('.single-progress-mark',jQuery(widget,jQuery(base)).parent()).remove()},getURLParam:function(name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href);if(results==null){return""}else return results[1]},getUrlParams:function(url){if(_.isUndefined(url))url=window.location.search;if(url.indexOf('?')>=0)url=url.substr(url.indexOf('?')+1);var result=[],names=url.match(/[^&=]+(?==[^&=]+)/g),params=url.match(/[^&=]=[^&=]+/g);names.forEach(function(i,k){result[i]=decodeURI(params[k].substr(2))});return result},getTarget:function(){return xliteConfig.target},getFormIdString:function(){return xliteConfig.form_id_name+'='+xliteConfig.form_id}};try{var xhr=window.ActiveXObject?new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();core.isRequesterEnabled=xhr?true:false}catch(e){};jQuery(document).ready(function(){core.isReady=true;core.trigger('load');for(var i=0;i<core.savedEvents.length;i++)core.trigger(core.savedEvents[i].name,core.savedEvents[i].params);core.savedEvents=[]});core.isDeveloperMode=xliteConfig.developer_mode
function isElement(obj,type){return obj&&typeof(obj.tagName)!='undefined'&&obj.tagName.toLowerCase()==type};jQuery.extend({getQueryParameters:function(str){return(str||document.location.search).replace(/(^\?)/,'').split("&").map(function(n){return n=n.split("="),this[n[0]]=n[1],this}.bind({}))[0]}});core.bind('load',function(){jQuery('input[type=checkbox]').each(function(){var checkbox=this;jQuery(checkbox).bind('click',function(){return!jQuery(checkbox).prop('readonly')})});jQuery('.model-form-buttons .button:first-child button').addClass('btn-warning')});core.microhandlers={};core.microhandlers.list={};core.microhandlers.initialRunned=false;core.microhandlers.supressRunOnAdd=false;core.microhandlers.supressRun=function(){var previous=this.supressRunOnAdd;this.supressRunOnAdd=true;return _.bind(function(){this.supressRunOnAdd=previous},this)};core.microhandlers.add=function(name,pattern,handler){this.list[name]={pattern:pattern,handler:handler};if(this.initialRunned&&!this.supressRunOnAdd)this.run(name)};core.microhandlers.run=function(name,base){base=base||document;if('undefined'!=typeof(this.list[name])&&this.list[name])if(_.isString(this.list[name].pattern)){jQuery(this.list[name].pattern,base).filter(_.bind(this.filterByMark(name),this)).each(this.list[name].handler).each(_.bind(this.assignMark(name),this))}else if(_.isFunction(this.list[name].pattern))this.list[name].pattern().filter(_.bind(this.filterByMark(name),this)).each(this.list[name].handler).each(_.bind(this.assignMark(name),this))};core.microhandlers.runInitial=function(){this.initialRunned=true;this.runAll(document)};core.microhandlers.runAll=function(base){_.each(_.keys(this.list),function(name){this.run(name,base)},this)};core.microhandlers.filterByMark=function(name){return function(idx,elm){return!jQuery(elm).data('microhandler-'+name)}};core.microhandlers.assignMark=function(name){return function(idx,elm){jQuery(elm).data('microhandler-'+name,true)}};core.microhandlers.add('BootstrapTooltip','[data-toggle="tooltip"]',function(event){jQuery(this).tooltip()});core.microhandlers.add('BootstrapPopover','[data-toggle="popover"]',function(event){if(!_.isUndefined(jQuery(this).startTooltip))jQuery(this).startTooltip()});core.bind('load',function(){core.microhandlers.runInitial()});core.bind('loader.loaded',function(event,widget){core.microhandlers.runAll(widget.base)});core.bind('vue-form.ready',function(event,element){core.microhandlers.runAll(element)});if(window.CoreAMD!==undefined){define('js/core',function(){return core})}else document.addEventListener('amd-ready',function(event){define('js/core',function(){return core})})